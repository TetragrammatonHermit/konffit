function ShortcutSetter(a,g,u,A,B,v,l,w){function C(){a.addEventListener("focus",function(){l()||B()||h("setShortcutInstruction",!0)});a.parentNode.addEventListener("webkitAnimationEnd",function(){m()})}function D(){a.addEventListener("mousemove",function(){clearTimeout(k);k=setTimeout(function(){f&&f.parentNode||h("shortcutReleaseNotesTooltip",!1)},500)});a.addEventListener("mouseout",function(){clearTimeout(k);m()})}function x(b){b=b.split("|");for(var a=0;a<b.length;a++)d.push(parseInt(b[a])),
c.push(p(d[a]));q();c=[];d=[]}function r(){a.parentNode.classList.remove("error");m()}function m(){clearTimeout(k);a.parentNode.classList.remove("shortcutTooltip","vanish");a.parentNode.removeAttribute("tooltip");f&&f.parentNode&&f.parentNode.removeChild(f)}function p(b){return s[b]?s[b]:w(b)?String.fromCharCode(w(b)):String.fromCharCode(b)}function y(){t();h("shortcutConflict",!1)}function t(){a.parentNode.classList.add("error")}function h(b,c){a.parentNode.classList.add("shortcutTooltip");a.parentNode.setAttribute("tooltip",
Browser.i18n.getMessage(b));f=document.createElement("style");var e=window.getComputedStyle(a.parentNode,":after"),e=parseInt(e.height)+parseInt(e.paddingTop)+parseInt(e.paddingBottom);f.innerText=".shortcutTooltip:before { top: "+(a.offsetTop+7)+"px; } .shortcutTooltip:after { top: "+(a.offsetTop-(e-26)/2)+"px; }";document.head.appendChild(f);c&&(k=setTimeout(function(){a.parentNode.classList.add("vanish")},3E3))}function q(){var b=c.indexOf("CTRL");-1<b&&(c[b]=c[0],c[0]="CTRL");var n=c.indexOf("CMD");
-1<n&&(c[n]=c[-1<b?1:0],c[-1<b?1:0]="CMD");var e=c.indexOf("ALT");if(-1<e){var d=(-1<b?1:0)+(-1<n?1:0);c[e]=c[d];c[d]="ALT"}var f=c.indexOf("SHIFT");-1<f&&(d=(-1<b?1:0)+(-1<n?1:0)+(-1<e?1:0),c[f]=c[d],c[d]="SHIFT");a.value=c.join(" + ")}var E={9:"Tab"},s={8:"DEL",13:"Enter",16:"SHIFT",17:"CTRL",18:"ALT",27:"ESC",32:"SPACE",37:"\u21e6",38:"\u21e7",39:"\u21e8",40:"\u21e9",91:/mac/i.test(window.navigator.userAgent)?"CMD":"CTRL",93:"CMD",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",
119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19"},c=[],d=[],z=g,k,f;x(g);this.removeConflict=r;this.showConflict=y;g=document.getElementById("markupShortcutsHeader");g&&g.compareDocumentPosition(a)===a.DOCUMENT_POSITION_FOLLOWING||(a.addEventListener("blur",function(){r();v()}),a.addEventListener("click",function(){l()||this.select()}),a.addEventListener("keyup",function(){if(0<d.length){var b,a;3<d.length?b={tooLong:!0}:(a=d.sort(function(b,
a){return b>a?1:b<a?-1:0}).join("|"),b=A(this,a));c=[];d=[];m();b?(x(z),b.conflict?y():b.tooLong?(t(),h("shortcutLengthError",!1)):b.noEsc&&(t(),h("shortcutNoEsc",!1))):(z=a,this.blur())}}),a.addEventListener("keydown",function(b){if(!l()){r();v();var a=b.which||b.keyCode||b.charCode;if(!E[a]){var e=p(a);e&&0>c.indexOf(e)&&(c.push(e),d.push(93==a?91:a),q());(b.metaKey||b.ctrlKey||s[a])&&b.preventDefault()}b.stopPropagation()}}),a.addEventListener("keypress",function(a){!l()&&0<d.length&&(65>d[d.length-
1]||90<d[d.length-1])&&(c[c.length-1]=p(a.charCode),q())}),"optionsPage"===u?C():"releaseNotes"===u&&D(),Object.preventExtensions(this))}Object.preventExtensions(ShortcutSetter);
