var ARCFourCipher=function(){function r(m){this.b=this.a=0;var h=new Uint8Array(256),n,l=0,q,a=m.length;for(n=0;256>n;++n)h[n]=n;for(n=0;256>n;++n)q=h[n],l=l+q+m[n%a]&255,h[n]=h[l],h[l]=q;this.s=h}r.prototype={encryptBlock:function(m){var h,n=m.length,l,q,a=this.a,c=this.b,f=this.s,s=new Uint8Array(n);for(h=0;h<n;++h)a=a+1&255,l=f[a],c=c+l&255,q=f[c],f[a]=q,f[c]=l,s[h]=m[h]^f[l+q&255];this.a=a;this.b=c;return s}};r.prototype.decryptBlock=r.prototype.encryptBlock;return r}(),calculateMD5=function(){var r=
new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21]),m=new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,
1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]);return function(h,n,l){var q=1732584193,a=-271733879,c=-1732584194,f=271733878,s=l+72&-64,k=new Uint8Array(s),
e;for(e=0;e<l;++e)k[e]=h[n++];k[e++]=128;for(h=s-8;e<h;)k[e++]=0;k[e++]=l<<3&255;k[e++]=l>>5&255;k[e++]=l>>13&255;k[e++]=l>>21&255;k[e++]=l>>>29&255;k[e++]=0;k[e++]=0;k[e++]=0;h=new Int32Array(16);for(e=0;e<s;){for(l=0;16>l;++l,e+=4)h[l]=k[e]|k[e+1]<<8|k[e+2]<<16|k[e+3]<<24;var v=q;n=a;var b=c,p=f,d,g;for(l=0;64>l;++l){16>l?(d=n&b|~n&p,g=l):32>l?(d=p&n|~p&b,g=5*l+1&15):48>l?(d=n^b^p,g=3*l+5&15):(d=b^(n|~p),g=7*l&15);var x=p,v=v+d+m[l]+h[g]|0;d=r[l];p=b;b=n;n=n+(v<<d|v>>>32-d)|0;v=x}q=q+v|0;a=a+n|
0;c=c+b|0;f=f+p|0}return new Uint8Array([q&255,q>>8&255,q>>16&255,q>>>24&255,a&255,a>>8&255,a>>16&255,a>>>24&255,c&255,c>>8&255,c>>16&255,c>>>24&255,f&255,f>>8&255,f>>16&255,f>>>24&255])}}(),NullCipher=function(){function r(){}r.prototype={decryptBlock:function(m){return m}};return r}(),AES128Cipher=function(){function r(a){var c=new Uint8Array(176);c.set(a);a=16;for(var f=1;176>a;++f)for(var s=c[a-3],k=c[a-2],e=c[a-1],l=c[a-4],s=n[s],k=n[k],e=n[e],l=n[l],s=s^h[f],b=0;4>b;++b)c[a]=s^=c[a-16],a++,
c[a]=k^=c[a-16],a++,c[a]=e^=c[a-16],a++,c[a]=l^=c[a-16],a++;this.key=c;this.buffer=new Uint8Array(16);this.bufferPosition=0}function m(a){var c,f,s=a.length,k=this.buffer;f=this.bufferPosition;var e=[],n=this.iv;for(c=0;c<s;++c)if(k[f]=a[c],++f,!(16>f)){var b,p=k;f=this.key;b=new Uint8Array(16);b.set(p);for(var d=p=void 0,g=void 0,h=d=g=void 0,d=0,g=160;16>d;++d,++g)b[d]^=f[g];for(p=9;1<=p;--p){g=b[13];b[13]=b[9];b[9]=b[5];b[5]=b[1];b[1]=g;g=b[14];d=b[10];b[14]=b[6];b[10]=b[2];b[6]=g;b[2]=d;g=b[15];
d=b[11];h=b[7];b[15]=b[3];b[11]=g;b[7]=d;b[3]=h;for(d=0;16>d;++d)b[d]=l[b[d]];d=0;for(g=16*p;16>d;++d,++g)b[d]^=f[g];for(d=0;16>d;d+=4){var g=q[b[d+1]],h=q[b[d+2]],m=q[b[d+3]],g=q[b[d]]^g>>>8^g<<24^h>>>16^h<<16^m>>>24^m<<8;b[d]=g>>>24&255;b[d+1]=g>>16&255;b[d+2]=g>>8&255;b[d+3]=g&255}}g=b[13];b[13]=b[9];b[9]=b[5];b[5]=b[1];b[1]=g;g=b[14];d=b[10];b[14]=b[6];b[10]=b[2];b[6]=g;b[2]=d;g=b[15];d=b[11];h=b[7];b[15]=b[3];b[11]=g;b[7]=d;b[3]=h;for(d=0;16>d;++d)b[d]=l[b[d]],b[d]^=f[d];for(f=0;16>f;++f)b[f]^=
n[f];n=k;e.push(b);k=new Uint8Array(16);f=0}this.buffer=k;this.bufferLength=f;this.iv=n;if(0==e.length)return new Uint8Array([]);if(1==e.length)return e[0];s=new Uint8Array(16*e.length);f=c=0;for(a=e.length;c<a;++c,f+=16)s.set(e[c],f);return s}var h=new Uint8Array([141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,
188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,
128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141]),n=new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,
190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,
148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]),l=new Uint8Array([82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,
179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,
20,99,85,33,12,125]),q=new Uint32Array([0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,
2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,
800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,
766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,
67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,
1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795]);r.prototype={decryptBlock:function(a){var c,f=a.length,l=this.buffer,k=this.bufferPosition;for(c=0;16>k&&c<f;++c,++k)l[k]=a[c];if(16>k)return this.bufferLength=k,new Uint8Array([]);this.iv=l;this.buffer=new Uint8Array(16);this.bufferLength=0;this.decryptBlock=
m;return this.decryptBlock(a.subarray(16))}};return r}(),CipherTransform=function(){function r(m,h){this.stringCipherConstructor=m;this.streamCipherConstructor=h}r.prototype={createStream:function(m){var h=new this.streamCipherConstructor;return new DecryptStream(m,function(n){return h.decryptBlock(n)})},decryptString:function(m){var h=new this.stringCipherConstructor;m=stringToBytes(m);m=h.decryptBlock(m);return bytesToString(m)}};return r}(),CipherTransformFactory=function(){function r(a,c,f,n,
k,e,h,b){var p=new Uint8Array(100),d=0,g;if(c)for(g=Math.min(32,c.length);d<g;++d)p[d]=c[d];for(c=0;32>d;)p[d++]=l[c++];c=0;for(g=f.length;c<g;++c)p[d++]=f[c];p[d++]=k&255;p[d++]=k>>8&255;p[d++]=k>>16&255;p[d++]=k>>>24&255;c=0;for(g=a.length;c<g;++c)p[d++]=a[c];4<=e&&!b&&(p[d++]=255,p[d++]=255,p[d++]=255,p[d++]=255);g=calculateMD5(p,0,d);d=h>>3;if(3<=e)for(c=0;50>c;++c)g=calculateMD5(g,0,d);h=g.subarray(0,d);if(3<=e){for(d=0;32>d;++d)p[d]=l[d];c=0;for(g=a.length;c<g;++c)p[d++]=a[c];a=new ARCFourCipher(h);
p=a.encryptBlock(calculateMD5(p,0,d));g=h.length;e=new Uint8Array(g);for(c=1;19>=c;++c){for(a=0;a<g;++a)e[a]=h[a]^c;a=new ARCFourCipher(e);p=a.encryptBlock(p)}}else a=new ARCFourCipher(h),p=a.encryptBlock(l);c=0;for(g=p.length;c<g;++c)if(n[c]!=p[c])return null;return h}function m(a,c,f){var h=a.get("Filter");isName(h)&&"Standard"==h.name||error("unknown encryption method");this.dict=a;h=a.get("V");(!isInt(h)||1!=h&&2!=h&&4!=h)&&error("unsupported encryption algorithm");this.algorithm=h;var k=a.get("Length")||
40;(!isInt(k)||40>k||0!=k%8)&&error("invalid key length");var e=stringToBytes(a.get("O")),n=stringToBytes(a.get("U")),b=a.get("P"),p=a.get("R"),d=4==h&&!1!==a.get("EncryptMetadata");this.encryptMetadata=d;c=stringToBytes(c);var g;f&&(g=stringToBytes(f));var m=r(c,g,e,n,b,p,k,d);if(!m&&!f)throw new PasswordException("No password given","needpassword");if(!m&&f){f=g;g=new Uint8Array(32);var m=0,u;for(u=Math.min(32,f.length);m<u;++m)g[m]=f[m];for(f=0;32>m;)g[m++]=l[f++];g=calculateMD5(g,0,m);m=k>>3;
if(3<=p)for(f=0;50>f;++f)g=calculateMD5(g,0,g.length);var t;if(3<=p){u=e;var w=new Uint8Array(m);for(f=19;0<=f;f--){for(t=0;t<m;++t)w[t]=g[t]^f;t=new ARCFourCipher(w);u=t.encryptBlock(u)}}else t=new ARCFourCipher(g.subarray(0,m)),u=t.encryptBlock(e);m=r(c,u,e,n,b,p,k,d)}if(!m)throw new PasswordException("Incorrect Password","incorrectpassword");this.encryptionKey=m;4==h&&(this.cf=a.get("CF"),this.stmf=a.get("StmF")||q,this.strf=a.get("StrF")||q,this.eff=a.get("EFF")||this.strf)}function h(a,c,f,h){var k=
new Uint8Array(f.length+9),e,l;e=0;for(l=f.length;e<l;++e)k[e]=f[e];k[e++]=a&255;k[e++]=a>>8&255;k[e++]=a>>16&255;k[e++]=c&255;k[e++]=c>>8&255;h&&(k[e++]=115,k[e++]=65,k[e++]=108,k[e++]=84);return calculateMD5(k,0,e).subarray(0,Math.min(f.length+5,16))}function n(a,c,f,l,k){a=a.get(c.name);var e;null!=a&&(e=a.get("CFM"));if(!e||"None"==e.name)return function(){return new NullCipher};if("V2"==e.name)return function(){return new ARCFourCipher(h(f,l,k,!1))};if("AESV2"==e.name)return function(){return new AES128Cipher(h(f,
l,k,!0))};error("Unknown crypto method")}var l=new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]),q=new Name("Identity");m.prototype={createCipherTransform:function(a,c){if(4==this.algorithm)return new CipherTransform(n(this.cf,this.stmf,a,c,this.encryptionKey),n(this.cf,this.strf,a,c,this.encryptionKey));var f=h(a,c,this.encryptionKey,!1),l=function(){return new ARCFourCipher(f)};return new CipherTransform(l,l)}};return m}();
