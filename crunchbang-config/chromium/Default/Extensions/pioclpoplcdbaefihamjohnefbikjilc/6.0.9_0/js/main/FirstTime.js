function FirstTime(){function c(a){b=a;Persistent.set("userFlowState",a)}function f(b){var g=extension.getBootstrapInfo("marketingUrl")+"/webclipper/whats_new/";extension.msgHandlerOpenTab({url:g+"?firstlaunch"},null,function(){c(a.CURRENT);b()})}var a={CURRENT:"normal",FIRST_TIME:"first",UPGRADE:"upgrade",MINOR_UPGRADE:"minor"},b=Persistent.get("userFlowState")||a.CURRENT,d=function(){var a=versionDetect.getLastVersionParsed(),b=versionDetect.getSourceVersionParsed();if(a&&a[0]){if(b[0]>a[0])return 1;
if(versionDetect.geq(b,[6,0,9])&&!versionDetect.geq(a,[6,0,9]))return 3}else return 2;return 0}();this.isUpgraded=function(){return b===a.UPGRADE||b===a.MINOR_UPGRADE};this.msgHandlerOnAction=function(e){b==a.FIRST_TIME||b==a.UPGRADE?f(e):b==a.MINOR_UPGRADE&&Browser.insertJS("third_party/port.js",function(){Browser.insertJS("js/common/Browser.js",function(){Browser.insertJS("content/UINames.js",function(){Browser.insertJS("content/release_notes/inject_frame.js");Browser.insertCSS("content/release_notes/inject_frame.css");
c(a.CURRENT);e()})})})};this.msgHandlerOnInit=function(c){b!=a.FIRST_TIME||YANDEX||f(c)};this.needToShowIntro=function(){return b==a.FIRST_TIME||b==a.UPGRADE||b==a.MINOR_UPGRADE};this.startUp=function(){b===a.GUIDED_TOUR?c(a.CURRENT):b==a.FIRST_TIME||2==d?c(a.FIRST_TIME):b==a.UPGRADE||1==d?c(a.UPGRADE):b!=a.MINOR_UPGRADE&&3!=d||c(a.MINOR_UPGRADE);Persistent.set("userFlowState",b)};Object.preventExtensions(this)}firstTime=new FirstTime;
