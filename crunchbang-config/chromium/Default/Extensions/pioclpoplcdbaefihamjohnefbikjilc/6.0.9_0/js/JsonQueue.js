var JsonQueue={};
(function(){function h(a,e,b,c){d[e.shardId].expensiveOpInflight=!0;3==c.length&&k(null,a,e.shardId,b,c)}function k(a,e,b,c,f){if(a)for(var g in f){if("function"==typeof f[g]){f[g](a);break}}else d[b].timeout=setTimeout(function(){JsonQueue.handleExpensiveOpComplete(b)},1E4),c.apply(e,f)}var d={};JsonQueue.handleExpensiveOpRequest=function(a,e){var b=Array.prototype.slice.call(arguments);b.shift();b.shift();var c=a.shardId;d[c]||(d[c]={expensiveOpInflight:!1,queue:[],timeout:0});for(var f in b)if("function"==
typeof b[f]){var g=b[f];b[f]=function(a,b){clearTimeout(d[c].timeout);JsonQueue.handleExpensiveOpComplete(c);g(a,b)};break}d[c].expensiveOpInflight?d[c].queue.push({attrs:a,func:e,args:b}):0<d[c].queue.length?d[c].queue.push({attrs:a,func:e,args:b}):h(this,a,e,b)};JsonQueue.handleExpensiveOpComplete=function(a){0<d[a].queue.length?(a=d[a].queue.shift(),h(this,a.attrs,a.func,a.args)):d[a].expensiveOpInflight=!1};JsonQueue.getShards=function(){return d};Object.preventExtensions(JsonQueue)})();
